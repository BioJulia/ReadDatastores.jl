```@meta
CurrentModule = ReadDatastores
DocTestSetup = quote
    using ReadDatastores, BioSequences
end
```

# Indexing

`Base.getindex` is defined for ReadDatastores:

```jldoctest indexing
julia> ds = open(PairedReads, "test/ecoli-pe.prseq", "my-ecoli-pe")
Paired Read Datastore 'my-ecoli-pe': 20 reads (10 pairs)

julia> ds[5]
300nt DNA Sequence:
NACATGCACTTCAACGGCATTACTGGTGACCTCTTCGTC…TTCTATCAACGCAAAAGGGTTACACAGATAATCGTCAGC
```

Indexing a read datastore creates a new sequence. If you want to load a sequence
from a datastore and into an existing sequence, then you can use the `load_sequence!`
method.

```jldoctest indexing
julia> seq = dna""
0nt DNA Sequence:
< EMPTY SEQUENCE >

julia> load_sequence!(ds, 6, seq)
300nt DNA Sequence:
ATTACTGCGATTACTGCTGCGAATTTTTTCATGTTTATT…GTCCACTGGTTTACACAAGGTCGTAAGGGAAAAGAGGCG

julia> seq
300nt DNA Sequence:
ATTACTGCGATTACTGCTGCGAATTTTTTCATGTTTATT…GTCCACTGGTTTACACAAGGTCGTAAGGGAAAAGAGGCG

```

# Iteration

The ReadDatastore types also support the `Base.iterate` interface:

```jldoctest indexing
julia> collect(ds)
20-element Array{LongSequence{DNAAlphabet{4}},1}:
 NGGGCTTTAAAATCCACTTTTTCCATATCGATAGTCACG…ATTTCTTCGATTCTTCTTTGTCACCGCAGCCAGCAAGAG
 GTGGGTTTTTATCGGCTGGCACATGTGTTGGGACAATTT…GGCTTTCAATACGCTGTTTTCCCTCGTTGTTTCATCTGT
 NTGAACTCCACATCCTGCGGATCGTAAACCGTCACCTCT…TCTTCCAGGCAGGCCGCCAGGGTATCACCTTCCAGACCA
 GATGAATCTGGCGGTTATTAACGGTAACAATAACCAGCA…AGACGGCAAACCGGCTGCAGGCGGTAGGTTGTTGCAGGT
 NACATGCACTTCAACGGCATTACTGGTGACCTCTTCGTC…TTCTATCAACGCAAAAGGGTTACACAGATAATCGTCAGC
 ATTACTGCGATTACTGCTGCGAATTTTTTCATGTTTATT…GTCCACTGGTTTACACAAGGTCGTAAGGGAAAAGAGGCG
 NCGGTTGAGTTCAAAGGCAAAGATTTGCTTGCGCTGTCG…TTTTCCGGCGGCGAGAAAAAGCGCAACGATTTTTTGCAA
 TTCGTCCCTGATATAGCACATGAACGTAATCAGGCTTGA…AATCTTCCGGCATCTTCAGGAGAGCGATTTTCTCTTCCA
 NACGACACATTACCGGAAATTCAGGCCGACCCGGACAGG…GTTGAACAACACGGTGGTACAATTCAGGTCGCAAGCCAG
 TCCACCACCAGAATATCGATATTATCGTGCGTCATCCTT…TCACGCCCGCGCCGCTTTCGCTGGCCGTCACGCTAATCA
 NCGTAACTTTATTCATATCTCTTCCCCCTCCCTGTACTT…TCTGTTACCGCATGGCGGCAGTGCGCTGGTCGATATGAC
 ATCGGGTAGGGGACGGAACGAATACGACAGTCAATATTC…AAGACTTTATCGTGCGGTCCGAACCGACTTTGTGGCGGC
 NGCCCTGGAGCTGGTGAAAGAAGGTCGAGCGCAAGCCTG…CAATCCTCGCGTGGCGTTGCTCAATATTGGTGAAGAAGA
 GAAAGGAACATCCTGACAACACCTTCCATCGTCTTTAAT…ATAAAGGCAAATTGCACCACCATGATGCTGTCCCAATCA
 NGTCTGGTGGTGCCTCTTTACTTAAGGAATTTCATCCTG…TAACGATGCCAGGCACCTGCGAAACTTTCCTGCACCAGC
 GACCGTTTTTCCCCAATCCGAGAACGCATAAATCCAGAC…TTTCTTCCCGGTAATGATACGTCACTATTGGAGTGGCCC
 NAGAGGCCACAGCGCGCCCATAATGGCGACTGAAAGCCA…TTTCACCGCGGTGACCGGAATCAGGGCAAATTCGACATG
 AAAAGGATCGCCGACCTTAACCATTCTGAATGTGATTGG…CTGGTGCCTGTCATATTTCGAACTCTGGGGGGACAGCAT
 NTGAGCAAATATGCCCGACCCAGCCTCATGACAGCGATA…AACCGAAAAAAAAGTAATCGTCGGCATGTCCGGCGGTGT
 AGGCTTTAAATTTGATCTCTTTGTTGCACAGAATATCCG…GCCAGGAAGAAACGGAGGAACCGACACCGCCGGCCATGC

```

# Buffers

When iterating over a `ReadDatastore` either using `Base.getindex` or `load_sequence!`,
you can sacrifice some memory for a buffer, to reduce the number of times the
hard disk is read, and speed up sequential access and iteration. You can use the
`buffer` method to wrap a datastore in such a buffer.

```jldoctest indexing
julia> bds = buffer(ds)
Buffered Paired Read Datastore 'my-ecoli-pe': 20 reads (10 pairs)

julia> for i in eachindex(bds)
           load_sequence!(bds, i, seq)
           println(length(seq))
       end
298
300
300
300
300
300
300
300
300
300
300
300
300
300
300
300
300
300
300
300

```